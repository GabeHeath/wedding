<ul id="scene" data-friction-x="0.1" data-friction-y="0.1" data-scalar-x="25" data-scalar-y="55" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); transform-style: preserve-3d; backface-visibility: hidden; position: relative;" data-mode="cursor">
  	  <li class="layer" data-depth="0.01"><%= image_tag("sun2.gif", id: "sun1", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.03"><%= image_tag("mountain1.png", id: "mountain1", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.05"><%= image_tag("buildings1.png", id: "buildings", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.05"><%= image_tag("cow-right.gif", id: "cows", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.08"><%= image_tag("cloud2.png", id: "cloud2", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.1"><%= image_tag("tree-hill1.png", id: "tree-hill1", class: "unselectable") %></li>
  	  <li class="layer" data-depth="0.15"><%= image_tag("cloud1.png", id: "cloud1", class: "unselectable", style: "position: relative;") %></li>
	  <li class="layer" data-depth="0.4">
	  	<ul class="main">
	  		<li><%= image_tag("hill2.png", id: "hill1", class: "unselectable") %></li>
	  		<li>
				<svg version="1.1" id="stream1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="95.7px" height="330.7px" viewBox="0 0 95.7 330.7" enable-background="new 0 0 95.7 330.7" xml:space="preserve">
<path id="ripple1" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" d="M25.1,0.3c0,0,72.5,77.5,70,120s-64.8,53.8-76,77.5
	s42.8,96.2,76.6,132.5"/>
</svg>

				<svg version="1.1" id="stream2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="109.3px" height="330.7px" viewBox="0 0 109.3 330.7" enable-background="new 0 0 109.3 330.7" xml:space="preserve">
<path id="ripple2" fill="none" stroke="#FFFFFF" stroke-miterlimit="10" d="M57.8,0.3c0,0,53.5,67.5,51,110s-66.8,54.8-78,78.5
	s45.9,105.2,79.6,141.5"/>
</svg>


			</li>
	  	</ul>
	  </li>
	  <!-- <li class="layer" data-depth="0.4"><img id="ripple" src="images/ripple.gif" class="unselectable"></li> -->
  	  <!-- <li class="layer" data-depth="0.2"><img id="tree" src="images/tree1.png"></li> -->
  </ul>

  <script>
  	$(document).ready(function() {

  		// Resize handler.
		(resize = function() {
			$('#scene')[0].style.width = window.innerWidth + 'px';
			$('#scene')[0].style.height = window.innerHeight + 'px';
		})();

		// Attach window listeners.
		window.onresize = _.debounce(resize, 200);
		window.onscroll = _.debounce(resize, 200);

  		$('#scene').parallax();

  		jQuery.expr.filters.offscreen = function(el) {
		  return (
		              //(el.offsetLeft + el.offsetWidth) < 0 ||
		              (el.offsetTop + el.offsetHeight) < 0 || 
		              (el.offsetLeft > window.innerWidth   || 
		              el.offsetTop > window.innerHeight)
		         );
		};

  		function start(element, length) {
			if ( $(element).is(':offscreen') ) {
		       $(element).css({ left: '-'+ $(element).width() +'px'});
		    }

		    $(element).animate({left: '+='+ length + ''}, 5000, 'linear', function(){ start(element, length); });
		}

		function cowMove() {
			$('#cows').attr('src', '<%= image_path('cow-right.gif') %>');
		    $('#cows').animate({left: '+='+ 65 + ''}, 20000, 'linear', function(){ $('#cows').attr('src', '<%= image_path('cow-left.gif') %>'); });
		    $('#cows').animate({left: '-='+ 65 + ''}, 20000, 'linear', function(){ cowMove(); });
		}



		// var box = $('#tree'),
	 //    // Create some clones (these make up the trail)
	 //    clones = $.map(Array(10), function(item, i){
	 //        return box.clone().css('opacity', 1 / (i + 1)).hide().insertAfter(box);
	 //    });

	 //    box.animate({
		//     top: '+=200',
		//     left: '+=200'
		// }, {
		//     duration: 5000,
		//     step: function(now, fx) {

		//         // On each step, set a timeout for each clone,
		//         // making it move to the required position.

		//         var prop = fx.prop;

		//         $.each(clones, function(i, clone){
		//             clone = $(clone).show();
		//             setTimeout(function(){
		//                 clone.css(prop, now);
		//             }, 50 * i);
		//         });

		//     }
		// });

		// function curve() {
		//     $('#tree').animate({top: '-=200',left: '-=200'}, 5000, function() {
		//         $('#tree').animate({top: '+=200', left: '+=200'}, 5000, function() {
		//             curve();
		//         });
		//     });
		// }







		start('#cloud1', 100);
		start('#cloud2', 50);
		cowMove();
		//curve();





  	});
  </script>
